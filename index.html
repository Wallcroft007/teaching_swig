<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<title>Pokedex</title>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/swig.js"></script>
</head>
<body>
	<!-- BARRA DE NAVEGACION -->
		<nav class="navbar navbar-default">
		  <div class="container-fluid">
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="#">Pokedex</a>
		    </div>
		  </div><!-- /.container-fluid -->
		</nav>
	<!-- FIN BARRA DE NAVEGACION -->

	
	<div class="container">

		<!-- ENCABEZADO -->
			<div class="row">
				<div class="page-header">
				  <h3>Usando Swig como motor de templates 
				  <div style="width: 200px;display:inline-block;float:right;">
				  	<select id="rango" class="form-control" style="display:inline-block;width: 100px;">
				  		<option value="1_10">1 al 10</option>
				  		<option value="11_20">11 al 20</option>
				  		<option value="21_30">21 al 30</option>
				  		<option value="31_40">31 al 40</option>
				  		<option value="41_50">41 al 50</option>
				  	</select>
				  	<button id="consultar" class="btn btn-primary btn-sm">Consultar</button>
				  </div>
				  </h3>
				</div>
			</div>
		<!-- FIN ENCABEZADO -->

		<div id="pokemon_container" class="row"></div>



	</div>
	<script type="text/template" id="template">
		<div class="col-md-3">
			<div class="panel panel-default">
			  <div class="panel-heading" style="text-align:center;">Bulbasaur</div>
			  <div class="panel-body">
			    <div>
			    	<a href="#" class="thumbnail">
				      <img src="http://pokeapi.co/media/img/1383571573.78.png" alt="...">
				    </a>
			    </div>
			    <div>
			    	<p>Este es un poquemon muy coqueto que todos aman y les gustaria tener alguno un dia de estos.</p>
			    	<p><strong>Species:</strong> <span class="text-capitalize">seed pokemon</span></p>
			    	<p><strong>Attack:</strong> 
			    		<span class="text-capitalize">49</span></p>
					<p><strong>Defense:</strong> <span class="text-capitalize">50</span></p>
			    </div>
			  </div>
			</div>
		</div>
	</script>
	<script>
		var html = $("#template").html();
		var render = swig.compile( html );

		var Pokemon = function(id){
			this.url_pokemon = "http://pokeapi.co/api/v1/pokemon/"+id;
			this.url_description = "http://pokeapi.co";
			this.url_sprite = "http://pokeapi.co";
			this.pokemon = {};
			var self = this;
			$.get(this.url_pokemon, function(data){
				self.pokemon = data;
				self.url_description = self.url_description+data.descriptions[0].resource_uri;
				self.url_sprite = self.url_sprite+data.sprites[0].resource_uri;
				$.get(self.url_description, function(data){
					self.pokemon['description'] = data;
					$.get(self.url_sprite, function(data){
						self.pokemon['sprite'] = data;
					});
				});
			});
			return this;
		};

		var crearPokemons = function()
		{
			var lista_pokemons = [];
			var rango = $("#rango").val().split("_");
			for( var i = parseInt(rango[0]); i <= parseInt(rango[1]); i++ ){
				lista_pokemons.push( new Pokemon(i) );
			}
			var html = render( { pokemons : lista_pokemons } );
			$("#pokemon_container").html(html);
		}

		$("#consultar").on('click', crearPokemons);

	</script>
</body>
</html>